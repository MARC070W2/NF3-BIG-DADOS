
import pandas as pd
import requests
import matplotlib.pyplot as plot

link = "https://raw.githubusercontent.com/miguel23Paraguai/NF3-BIG-DATA/main/world_alcohol%20(4)%20Trabalho%20final.csv"
df = pd.read_csv(link)
df

''' questao 1 '''

''' letra a '''

import pandas as pd

df = pd.DataFrame(data)

grouped_df = df.groupby('Beverage Types')

for group, group_df in grouped_df:

    print(f"Group: {group}")
    print(group_df)
    print()

''' letra b '''

import pandas as pd

df = pd.DataFrame(data)

grouped_df = df.groupby(['WHO region', 'Year'])

for group, group_df in grouped_df:

    print(f"Group: {group}")
    print(group_df)
    print()

''' letra c '''

import pandas as pd

df = pd.DataFrame(data)

# Contagem da ocorrência de regiões

region_count = df['WHO region'].value_counts()

# Contagem da ocorrência de países

country_count = df['Country'].value_counts()

# Soma da coluna de valores por bebida

value_sum_by_beverage = df.groupby('Beverage Types')['Display Value'].sum()

print("Contagem da ocorrência de regiões:")
print(region_count)
print()

print("Contagem da ocorrência de países:")
print(country_count)
print()

print("Soma da coluna de valores por bebida:")
print(value_sum_by_beverage)


''' letra d '''

import pandas as pd
import matplotlib.pyplot as plt

df = pd.DataFrame(data)

# Agrupar valores por tipo de bebida

grouped = df.groupby('Beverage Types')['Display Value']

# Média por tipo de bebida

mean = grouped.mean()

# Moda por tipo de bebida

mode = grouped.apply(lambda x: x.mode().iloc[0])

# Mediana por tipo de bebida

median = grouped.median()

# Estatística descritiva por tipo de bebida

statistics = grouped.describe()

# Gráfico de comparação dos valores por tipo de bebida

fig, ax = plt.subplots()

grouped.plot(kind='box', ax=ax)
ax.set_ylabel('Value')
ax.set_title('Comparison of Values by Beverage Types')
plt.show()

print("Média por tipo de bebida:")
print(mean)
print()

print("Moda por tipo de bebida:")
print(mode)
print()

print("Mediana por tipo de bebida:")
print(median)
print()

print("Estatística descritiva por tipo de bebida:")
print(statistics)


''' letra e '''

''' i '''
import pandas as pd

df = pd.DataFrame(data)

# Filtrar os dados do ano de 1985

filtered_df = df.loc[df['Year'] == 1985]

# Mostrar a coluna de bebidas do ano de 1985

beverage_column = filtered_df['Beverage Types']
print(beverage_column)

''' ii ''' 

import pandas as pd

df = pd.DataFrame(data)

# Filtrar os dados com valor de "Display Value" acima de 4

filtered_df = df.loc[df['Display Value'] > 4]

# Mostrar a coluna "WHO region" dos dados filtrados

region_column = filtered_df['WHO region']
print(region_column)


''' questao 2 '''

https://drive.google.com/file/d/1lnqYHylEWT8cN6vPZ-NRR8KfFAPNq43r/view?usp=drive_link

''' letra a '''



















